// CodeMirror, copyright (c) by Marijn Haverbeke and others
// Distributed under an MIT license: https://codemirror.net/LICENSE


!function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){"use strict";function e(t,e,r){return r?t.indexOf(e)>=0:0==t.lastIndexOf(e,0)}function r(r,i){function s(){return{list:d,from:p?n(f.line,null==u?g.start:u):f,to:p?n(f.line,g.end):f}}var a=i&&i.schemaInfo,o=i&&i.quoteChar||'"',l=i&&i.matchInMiddle;if(a){var f=r.getCursor(),g=r.getTokenAt(f);g.end>f.ch&&(g.end=f.ch,g.string=g.string.slice(0,f.ch-g.start));var c=t.innerMode(r.getMode(),g.state);if(c.mode.xmlCurrentTag){var h,u,d=[],p=!1,v=/\btag\b/.test(g.type)&&!/>$/.test(g.string),m=v&&/^\w/.test(g.string);if(m){var y=r.getLine(f.line).slice(Math.max(0,g.start-2),g.start),x=/<\/$/.test(y)?"close":/<$/.test(y)?"open":null;x&&(u=g.start-("close"==x?2:1))}else v&&"<"==g.string?x="open":v&&"</"==g.string&&(x="close");var C=c.mode.xmlCurrentTag(c.state);if(!v&&!C||x){m&&(h=g.string),p=x;var b=c.mode.xmlCurrentContext?c.mode.xmlCurrentContext(c.state):[],c=b.length&&b[b.length-1],O=c&&a[c],w=c?O&&O.children:a["!top"];if(w&&"close"!=x)for(var A=0;A<w.length;++A)h&&!e(w[A],h,l)||d.push("<"+w[A]);else if("close"!=x)for(var M in a)!a.hasOwnProperty(M)||"!top"==M||"!attrs"==M||h&&!e(M,h,l)||d.push("<"+M);c&&(!h||"close"==x&&e(c,h,l))&&d.push("</"+c+">")}else{var O=C&&a[C.name],P=O&&O.attrs,$=a["!attrs"];if(!P&&!$)return;if(P){if($){var I={};for(var T in $)$.hasOwnProperty(T)&&(I[T]=$[T]);for(var T in P)P.hasOwnProperty(T)&&(I[T]=P[T]);P=I}}else P=$;if("string"==g.type||"="==g.string){var j,y=r.getRange(n(f.line,Math.max(0,f.ch-60)),n(f.line,"string"==g.type?g.start:g.end)),q=y.match(/([^\s\u00a0=<>\"\']+)=$/);if(!q||!P.hasOwnProperty(q[1])||!(j=P[q[1]]))return;if("function"==typeof j&&(j=j.call(this,r)),"string"==g.type){h=g.string;var L=0;/['"]/.test(g.string.charAt(0))&&(o=g.string.charAt(0),h=g.string.slice(1),L++);var k=g.string.length;if(/['"]/.test(g.string.charAt(k-1))&&(o=g.string.charAt(k-1),h=g.string.substr(L,k-2)),L){var H=r.getLine(f.line);H.length>g.end&&H.charAt(g.end)==o&&g.end++}p=!0}var R=function(t){if(t)for(var r=0;r<t.length;++r)h&&!e(t[r],h,l)||d.push(o+t[r]+o);return s()};return j&&j.then?j.then(R):R(j)}"attribute"==g.type&&(h=g.string,p=!0);for(var z in P)!P.hasOwnProperty(z)||h&&!e(z,h,l)||d.push(z)}return s()}}}var n=t.Pos;t.registerHelper("hint","xml",r)});
//# sourceMappingURL=xml-hint.js.map